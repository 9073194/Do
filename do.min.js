(function(){var i=document,k={};function n(a){return typeof a==="object"&&a.length}function r(a){window.console&&window.console.log&&window.console.log(a)}var h={core_lib:["http://code.jquery.com/jquery-1.4.1.js"],mods:{}},l={};function j(a,d,c,e){if(a)if(k[a]){l[a]=false;e&&e(a)}else if(l[a])setTimeout(function(){j(a,d,c,e)},10);else{l[a]=true;var b,f=d||a.toLowerCase().substring(a.lastIndexOf(".")+1);if(f==="js"){b=i.createElement("script");b.setAttribute("type","text/javascript");b.setAttribute("src",
a)}else if(f==="css"){b=i.createElement("link");b.setAttribute("type","text/css");b.setAttribute("rel","stylesheet");b.setAttribute("href",a);k[a]=true}if(c)b.charset=c;if(f==="css"){i.getElementsByTagName("head")[0].appendChild(b);e&&e(a)}else{b.onload=b.onreadystatechange=function(){if(!this.readyState||this.readyState==="loaded"||this.readyState==="complete"){k[this.getAttribute("src")]=true;e&&e(this.getAttribute("src"));b.onload=b.onreadystatechange=null}};i.getElementsByTagName("head")[0].appendChild(b)}}}
function s(a){if(a&&n(a)){for(var d=0,c,e=[],b=h.mods,f=[],m={},p=function(g){var t=0,o;if(m[g])return f;m[g]=true;if(b[g].requires){for(o=b[g].requires;g=o[t++];){b[g]&&p(g);f.push(g)}return f}return f};c=a[d++];){if(b[c]&&b[c].requires&&b[c].requires[0]){f=[];m={};e=e.concat(p(c))}e.push(c)}return e}}function q(a){if(a&&n(a)){this.queue=a;this._skip={}}}q.prototype={_Timeout:6000,_interval:10,start:function(){var a=this;if(this.current=this.next()){this._outTimer=setTimeout(function(){r('[DoubanJS] "'+
a.current+'" timeout.');a._skip[a.current]=true;a.start()},this._Timeout);this.run()}else this.end=true},run:function(){var a=this,d;if(typeof this.current==="function"){this.clearTimer();this.current();this.start()}else if(typeof this.current==="string")if(h.mods[this.current]){d=h.mods[this.current];j(d.path,d.type,d.charset,function(c){if(!a._skip[c]){a.clearTimer();a.start()}})}else if(/\.js|\.css/i.test(this.current))j(this.current,"","",function(c){if(!a._skip[c]){a.clearTimer();a.start()}});
else{this.clearTimer();this.start()}},clearTimer:function(){clearTimeout(this._outTimer)},next:function(){return this.queue.shift()}};j(h.core_lib[0],"js");this.Do=function(){var a=Array.slice.call(null,arguments);a=new q(s(h.core_lib.concat(a)));a.start()};this.Do.add=function(a,d){!a||!d||!d.path||(h.mods[a]=d)}})();
